# Парсер цен с маркетплейсов

## Описание

Программа предназначена для:
1. Чтения Excel-файла с товарами (Прайс_Ingco+WadFow.xlsx)
2. Поиска колонки с артикулами (латинские буквы, цифры и дефис)
3. Фильтрации товаров стоимостью выше 1500 рублей
4. Поиска цен на Ozon и Wildberries для каждого артикула
5. Добавления новых колонок с ценами и ссылками в Excel-файл

## Структура программы

Программа состоит из следующих компонентов:

### 1. Класс `PriceParser`
- `load_and_filter_data()` - загрузка и фильтрация данных из Excel
- `search_ozon_price(article)` - поиск цены на Ozon (реализация описана ниже)
- `search_wildberries_price(article)` - поиск цены на Wildberries (реализация описана ниже)
- `process_article(article)` - обработка одного артикула
- `process_articles(articles)` - обработка списка артикулов
- `save_results_to_excel(df, results, output_path)` - сохранение результатов

### 2. Основные функции
- `main()` - основная функция программы

## Текущая реализация

Текущая реализация показывает структуру программы и использует фиктивные данные для демонстрации работы. 
В реальной реализации нужно заменить методы `search_ozon_price` и `search_wildberries_price` на реальные 
HTTP-запросы к маркетплейсам.

## Проблемы с доступом к сайтам

При тестировании были обнаружены следующие проблемы:
- **Ozon**: Возвращает статус 403 (доступ запрещен) при автоматических запросах
- **Wildberries**: Возвращает статус 498 при автоматических запросах

Эти ограничения введены для предотвращения автоматического парсинга.

## Возможные решения для полноценной реализации

### 1. Использование официальных API
- Проверить наличие официальных API у Ozon и Wildberries для получения цен
- Регистрация как разработчика и получение API-ключей

### 2. Использование Selenium WebDriver
- Установка браузера (Chrome/Firefox) и драйверов
- Использование обходов детекции автоматизации
- Пример кода в файле `parser_selenium.py`

### 3. Использование прокси-серверов
- Использование списка прокси-серверов для распределения запросов
- Ротация IP-адресов для избежания блокировок

### 4. Использование сторонних сервисов
- Использование сервисов, предоставляющих API для получения цен с маркетплейсов
- Обращение к специализированным компаниям по парсингу данных

## Запуск программы

```bash
python3 final_parser.py
```

## Результаты

Программа создает файл `Результат_парсинга_цен.xlsx` с:
- Исходными данными
- Новыми колонками: 'Ozon Цена', 'Ozon Ссылка', 'Wildberries Цена', 'Wildberries Ссылка'

## Технические детали

- Язык программирования: Python 3.12
- Библиотеки: pandas, aiohttp, beautifulsoup4, selenium
- Формат входных данных: Excel (.xlsx)
- Формат выходных данных: Excel (.xlsx)

## Комментарии к коду

Код полностью прокомментирован на русском языке, показывает архитектуру программы и места, 
где должна быть реализована логика получения данных с маркетплейсов.

## Тестирование

Программа была протестирована с фиктивными данными и показывает корректную работу 
всех компонентов системы.